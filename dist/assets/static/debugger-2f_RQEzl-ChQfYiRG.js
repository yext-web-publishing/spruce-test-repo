import{p as k,l as a,X as j}from"./Hours-CQ0fpklp.js";import{r as m}from"./index-B5OtZns-.js";import{r as N}from"./index-BOtJShKb.js";import"./index-CcsU9V5J.js";import"./preload-helper-D58fUZad.js";import"./commonjsHelpers-DZNb-E5g.js";function D(){return k().name!=="browser"||window.hasOwnProperty("debuggerInitialized")?null:(window.debuggerInitialized=!0,N.createPortal(a.jsx(E,{}),document.body))}const h={};function E(){const[e,l]=m.useState(),[n,s]=m.useState([]),[c,i]=m.useState(!1),t=r=>{l(e===r?void 0:r)};return m.useEffect(()=>(document.documentElement.classList.add("xYextDebug"),document.querySelectorAll("[data-ya-scope]").forEach(r=>{const o=r.dataset.yaScope,u=r.querySelectorAll("[data-ya-track]");u.forEach((d,p)=>{const g=d.dataset.yaTrack;d.addEventListener("mouseenter",()=>{s([{eventEl:d,eventName:`${o}_${g}`,key:`${o}_${g}_${p}`}])}),d.addEventListener("mouseleave",()=>{s([])})}),o&&(h.hasOwnProperty(o)?h[o].events=[...h[o].events,...Array.from(u)]:h[o]={scope:r,events:Array.from(u)})}),i(!0),()=>{document.documentElement.classList.remove("xYextDebug")}),[]),c?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"analytics-debugger",children:[a.jsxs("div",{className:"analytics-debugger-toggles",children:[a.jsx("button",{className:j("analytics-debugger-toggle",{"is-active":e==="Events"}),onClick:()=>t("Events"),children:"Events"}),a.jsx("button",{className:j("analytics-debugger-toggle",{"is-active":e==="Scopes"}),onClick:()=>t("Scopes"),children:"Scopes"})]}),e&&a.jsx("div",{className:"analytics-debugger-tabs",children:e==="Events"?a.jsx($,{data:h,setTooltips:s}):a.jsx(Y,{data:h,setTooltips:s})})]}),a.jsx(C,{tooltips:n})]}):null}function $(e){const{data:l,setTooltips:n}=e,[s,c]=m.useState(),[i,t]=m.useState(""),r=(o,u,d)=>{o.scrollIntoView({behavior:"smooth",block:"nearest"}),s&&s.classList.remove("analytics-event-highlight"),c(o),o.classList.add("analytics-event-highlight"),t(d),n([{eventEl:o,eventName:u,key:d}])};return a.jsxs("div",{className:"analytics-debugger-tab",children:[a.jsx("h2",{className:"analytics-debugger-tab-title",children:"Event Names"}),a.jsx("ul",{className:"analytics-debugger-list",children:Object.entries(l).map(([o,u])=>u.events.map((d,p)=>{const g=`${o}_${d.dataset.yaTrack}`,b=`${g}_${p}`;return a.jsx("li",{className:"analytics-debugger-listItem",children:a.jsx("button",{className:j("analytics-debugger-button",{"is-active":b===i}),onClick:()=>r(d,g,b),children:g})},b)}))})]})}function Y(e){const{data:l,setTooltips:n}=e,[s,c]=m.useState(""),i=t=>{const r=l[t];r.scope.scrollIntoView({behavior:"smooth",block:"nearest"}),c(t),n(r.events.map((o,u)=>({eventEl:o,eventName:`${t}_${o.dataset.yaTrack}`,key:`${t}_${o.dataset.yaTrack}_${u}`})))};return a.jsxs("div",{className:"analytics-debugger-tab",children:[a.jsx("h2",{className:"analytics-debugger-tab-title",children:"Scope Names"}),a.jsx("ul",{className:"analytics-debugger-list",children:Object.keys(l).map((t,r)=>a.jsx("li",{className:"analytics-debugger-listItem",children:a.jsx("button",{className:j("analytics-debugger-button",{"is-active":t===s}),onClick:()=>i(t),children:t})},t+r))})]})}function C(e){const l=m.useRef({});return m.useEffect(()=>{if(l.current)for(const n of Object.values(l.current)){const s=Object.values(l.current).map(c=>c.el).filter(c=>c!==n.el);S(n,s),n.el.style.visibility="visible"}},[e.tooltips]),a.jsx(a.Fragment,{children:e.tooltips.map(n=>a.jsx("div",{style:{visibility:"hidden"},className:"analytics-debugger-tooltip",ref:s=>{s?l.current[n.key]={el:s,tooltip:n}:delete l.current[n.key]},children:a.jsx("span",{children:n.eventName})},n.key))})}function S(e,l){for(let n=0;n<9;n++){const s=T(e.tooltip.eventEl.getBoundingClientRect(),e.el,n);if(e.el.style.inset=`${s.top} auto auto ${s.left}`,!!B(e.el.getBoundingClientRect().left,e.el.getBoundingClientRect().top+window.scrollY,e.el.getBoundingClientRect().right,e.el.getBoundingClientRect().bottom+window.scrollY))continue;let c=!0;for(let i=0;i<l.length;i++){const t=l[i];R(e.el,t)&&(c=!1)}if(c)break}}function R(e,l){const n=e.getBoundingClientRect().top+window.scrollY,s=e.getBoundingClientRect().left,c=n+e.clientHeight,i=s+e.clientWidth,t=l.getBoundingClientRect().top+window.scrollY,r=l.getBoundingClientRect().left,o=t+l.clientHeight,u=r+l.clientWidth,d=(p,g,b,x,y,v,f,w)=>b<=y&&y<=f&&x<=v&&v<=w||b<=p&&p<=f&&x<=g&&g<=w||b<=p&&p<=f&&x<=v&&v<=w||b<=y&&y<=f&&x<=g&&g<=w;return d(s,n,r,t,i,c,u,o)||d(r,t,s,n,u,o,i,c)}function B(e,l,n,s){return e<0||n>window.innerWidth||l<0||s>document.documentElement.scrollHeight}function T(e,l,n){const s=l.clientHeight,c=l.clientWidth;let i,t;switch(n){case 0:{t=window.scrollY+e.top-s+"px",i=e.left-c+"px";break}case 1:{t=window.scrollY+e.top-s+"px",i=e.left+"px";break}case 2:{t=window.scrollY+e.top-s+"px",i=e.right+"px";break}case 3:{t=window.scrollY+e.top-s+"px",i=e.right-c+"px";break}case 4:{t=window.scrollY+e.bottom+"px",i=e.left-c+"px";break}case 5:{t=window.scrollY+e.bottom+"px",i=e.left+"px";break}case 6:{t=window.scrollY+e.bottom+"px",i=e.right-c+"px";break}case 7:{t=window.scrollY+e.bottom+"px",i=e.right+"px";break}default:t=0,i=0}return{top:t,left:i}}export{E as AnalyticsDebuggerInternal,D as default};
