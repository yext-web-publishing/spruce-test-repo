import { loadViteModule } from "./loadViteModule.js";
import {
  convertTemplateModuleToTemplateModuleInternal
} from "../../../common/src/template/internal/types.js";
const templateNameToTemplateFilepath = /* @__PURE__ */ new Map();
const findTemplateModuleInternalByName = async (devserver, templateName, templateFilepaths) => {
  const templateFilepath = templateNameToTemplateFilepath.get(templateName);
  if (templateFilepath) {
    return await loadTemplateModuleInternal(devserver, templateFilepath);
  }
  for (const templateFilepath2 of templateFilepaths) {
    const templateModuleInternal = await loadTemplateModuleInternal(
      devserver,
      templateFilepath2
    );
    if (templateModuleInternal.config.templateType !== "entity") {
      continue;
    }
    templateNameToTemplateFilepath.set(
      templateModuleInternal.config.name,
      templateFilepath2
    );
    if (templateName === templateModuleInternal.config.name) {
      return templateModuleInternal;
    }
  }
  return null;
};
const loadTemplateModuleInternal = async (devserver, templateFilepath) => {
  const templateModule = await loadViteModule(
    devserver,
    templateFilepath
  );
  return convertTemplateModuleToTemplateModuleInternal(
    templateFilepath,
    templateModule,
    false
  );
};
export {
  findTemplateModuleInternalByName,
  loadTemplateModuleInternal
};
