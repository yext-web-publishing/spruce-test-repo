import send404 from "./send404.js";
import { loadModuleInternal } from "../ssr/findMatchingModule.js";
import serveModule from "./serveModule.js";
const serverRenderModule = ({ vite, modulePath }) => async (req, res, next) => {
  try {
    const moduleInternal = await loadModuleInternal(vite, modulePath);
    if (!moduleInternal) {
      const moduleName = req.originalUrl.substring(req.originalUrl.lastIndexOf("/") + 1).toLowerCase();
      send404(res, `Cannot find module for: ${moduleName}`);
      return;
    }
    await serveModule(res, moduleInternal, vite, req.originalUrl);
  } catch (e) {
    next(e);
  }
};
export {
  serverRenderModule
};
